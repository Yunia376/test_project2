#include <Wire.h>
#include <LiquidCrystal_I2C.h>
#include "DHT.h"

#define DHTPIN 2
#define DHTTYPE DHT22

#define LED_MERAH 3
#define LED_HIJAU 4  // Ganti dari LED_BIRU
#define LED_KUNING 5
#define BUZZER 6

DHT dht(DHTPIN, DHTTYPE);
LiquidCrystal_I2C lcd(0x27, 16, 2);

void setup() {
  lcd.begin(16, 2);
  lcd.backlight();
  dht.begin();

  pinMode(LED_MERAH, OUTPUT);
  pinMode(LED_HIJAU, OUTPUT);
  pinMode(LED_KUNING, OUTPUT);
  pinMode(BUZZER, OUTPUT);

  lcd.setCursor(0, 0);
  lcd.print("Termometer LCD");
  delay(2000);
}

// Fungsi buzzer untuk buzzer pasif
void bunyikanBuzzer(int durasi, int jeda, int ulang) {
  for (int i = 0; i < ulang; i++) {
    tone(BUZZER, 1000);       // Bunyikan buzzer dengan frekuensi 1000 Hz
    delay(durasi);
    noTone(BUZZER);           // Matikan suara
    delay(jeda);
  }
}

void loop() {
  float suhu = dht.readTemperature();

  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("Suhu: ");
  lcd.print(suhu);
  lcd.print(" C");

  if (suhu <= 10) {
    digitalWrite(LED_HIJAU, HIGH);
    digitalWrite(LED_KUNING, LOW);
    digitalWrite(LED_MERAH, LOW);
    bunyikanBuzzer(200, 800, 2);  // Bip pelan
  } else if (suhu > 10 && suhu <= 20) {
    digitalWrite(LED_HIJAU, LOW);
    digitalWrite(LED_KUNING, HIGH);
    digitalWrite(LED_MERAH, LOW);
    bunyikanBuzzer(150, 300, 3);  // Bip sedang
  } else {
    digitalWrite(LED_HIJAU, LOW);
    digitalWrite(LED_KUNING, LOW);
    digitalWrite(LED_MERAH, HIGH);
    bunyikanBuzzer(100, 100, 5);  // Bip cepat
  }

  delay(2000);
}
